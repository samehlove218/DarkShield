name: Build & Upload DarkShield APK

on:
  push:
      branches: [ main ]
        workflow_dispatch:

        jobs:
          build:
              runs-on: ubuntu-latest

                  steps:
                        - name: Checkout code
                                uses: actions/checkout@v4

                                      - name: Set up Java 17
                                              uses: actions/setup-java@v4
                                                      with:
                                                                distribution: temurin
                                                                          java-version: '17'

                                                                                - name: Set up Android SDK
                                                                                        uses: r0adkll/setup-android@v2
                                                                                                with:
                                                                                                          api-levels: 33
                                                                                                                    build-tools: '30.0.3'
                                                                                                                              ndk: ''
                                                                                                                                        emulator: false

                                                                                                                                              - name: Accept SDK licenses
                                                                                                                                                      run: yes | sdkmanager --licenses

                                                                                                                                                            - name: Enable AndroidX and Jetifier
                                                                                                                                                                    run: |
                                                                                                                                                                              echo "android.useAndroidX=true" >> gradle.properties
                                                                                                                                                                                        echo "android.enableJetifier=true" >> gradle.properties

                                                                                                                                                                                              - name: Make gradlew Executable
                                                                                                                                                                                                      run: chmod +x ./gradlew

                                                                                                                                                                                                            - name: Clean and Build APK (Release)
                                                                                                                                                                                                                    run: ./gradlew clean assembleRelease --no-daemon --stacktrace

                                                                                                                                                                                                                          - name: Upload APK Artifact
                                                                                                                                                                                                                                  uses: actions/upload-artifact@v4
                                                                                                                                                                                                                                          with:
                                                                                                                                                                                                                                                    name: app-release-apk
                                                                                                                                                                                                                                                              path: app/build/outputs/apk/release/app-release.apk